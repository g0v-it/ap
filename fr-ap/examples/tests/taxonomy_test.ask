PREFIX fr: <http://linkeddata.center/botk-fr/v1#>
PREFIX qb: <http://purl.org/linked-data/cube#>
PREFIX skos: <http://www.w3.org/2004/02/skos/core#>

ASK {
    ?scheme a skos:ConceptScheme.

    # No duplicated concepts in facts of the same financtial report
    {
        ?fact1 a fr:Fact ; fr:concept ?concept1; qb:dataSet ?fr.
        ?fact2 a fr:Fact ; fr:concept ?concept2; qb:dataSet ?fr.
        FILTER( ?fact1 != ?fact2 )
        FILTER( ?concept1 != ?concept2 )
        
        # two facts concepts must not be correlated
        FILTER NOT EXISTS { ?concept1 skos:exactMatch|skos:skos:closeMatch ?concept2 }
        FILTER NOT EXISTS { ?concept1 skos:narrower+ ?concept2 }
        FILTER NOT EXISTS { ?concept1 skos:boarder+ ?concept2 }
    }
    
}
    